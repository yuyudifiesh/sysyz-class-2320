<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–‡ä»¶ä¸‹è½½</title>
  <style>
    body, html {margin:0;padding:0;height:100%;overflow:hidden;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}
    #embed-container {position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;}
    #loading-overlay {position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(255,255,255,0.9);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:1001;transition:opacity 0.5s ease;}
    .spinner {width:50px;height:50px;border:3px solid rgba(0,0,0,0.1);border-radius:50%;border-top-color:#3498db;animation:spin 1s ease-in-out infinite;margin-bottom:20px;}
    .spinner.error {border-top-color:#e74c3c;} /* çº¢è‰²åŠ è½½åŠ¨ç”» */
    @keyframes spin {to {transform:rotate(360deg);}}
    #error-message {display:none;color:red;text-align:center;padding:20px;z-index:1002;}
    footer { position: absolute;bottom: 0;left: 0;width: 100%;text-align: center;}
    .loading-messages { text-align: center; max-width: 300px; } /* æ–°å¢æ ·å¼ */
  </style>
</head>
<body>
  <div id="loading-overlay">
    <div class="spinner" id="loading-spinner"></div>
    <div class="loading-messages" id="loading-text-container"> <!-- ä¿®æ”¹ä¸ºå®¹å™¨ -->
      <p id="loading-text">æ­£åœ¨åˆå§‹åŒ–â€¦â€¦</p>
    </div>
    <footer>
      <h6>Â© <span id="year"></span> yuyudifiesh</h6>
    </footer>
  </div>
  <div id="error-message">
    <h3>å®šå‘å¤±è´¥</h3>
    <p>å¯èƒ½ç”±äºè·¨åŸŸé™åˆ¶æˆ–ç½‘ç»œé—®é¢˜å¯¼è‡´æ— æ³•åŠ è½½å†…å®¹ã€‚</p>
  </div>
  <div id="embed-container">
    <embed id="file-embed" src="https://share.feijipan.com/s/TSNdUNhF?code=20ka" type="text/html" />
  </div>
  <script>
    const embedElement = document.getElementById('file-embed');
    const loadingOverlay = document.getElementById('loading-overlay');
    const errorMessage = document.getElementById('error-message');
    const loadingSpinner = document.getElementById('loading-spinner');
    const loadingTextContainer = document.getElementById('loading-text-container'); // å¼•ç”¨æ–°å®¹å™¨
    let loadingTimer;
    let checkTimer;
    let isLoaded = false;
    let urlVerified = false;
    const TARGET_DOMAIN = 'feijipn.com';

    // åˆå§‹åŒ–åŠ è½½è®¡æ—¶å™¨
    function initLoadingTimer() {
      loadingTimer = setTimeout(() => {
        if (isLoaded && urlVerified) {
          hideLoading();
        } else {
          // 10ç§’åURLæœªéªŒè¯æˆ–åŠ è½½æœªå®Œæˆï¼Œæ˜¾ç¤ºé”™è¯¯çŠ¶æ€
          setLoadingError();
        }
      }, 10000);
    }

    // è®¾ç½®åŠ è½½é”™è¯¯çŠ¶æ€ - ä¿®æ”¹ä¸ºå¤šè¡Œæ–‡æœ¬
    function setLoadingError() {
      loadingSpinner.classList.add('error');
      
      // æ¸…ç©ºå®¹å™¨
      loadingTextContainer.innerHTML = '';
      
      // æ·»åŠ å¤šè¡Œæ–‡æœ¬
      const errorMessages = [
        'å»ºç«‹ä¸ feijipan.com å®‰å…¨è¿æ¥æ—¶å‡ºé”™',
        'ğŸ“±--âœ…--ğŸŒ--âŒ--ğŸ”'
      ];
      
      errorMessages.forEach(message => {
        const p = document.createElement('p');
        p.textContent = message;
        p.className = 'mb-1';
        loadingTextContainer.appendChild(p);
      });
    }

    // æ£€æŸ¥åµŒå…¥å†…å®¹çš„URL
    function checkEmbedUrl() {
      try {
        // å°è¯•è·å–åµŒå…¥å†…å®¹çš„URL
        const embedUrl = embedElement.src || '';
        
        if (embedUrl.includes(TARGET_DOMAIN)) {
          urlVerified = true;
          clearInterval(checkTimer);
          
          // å¦‚æœåŠ è½½å·²å®Œæˆï¼Œç«‹å³éšè—åŠ è½½å±‚
          if (isLoaded) {
            // å»¶è¿Ÿnç§’åéšè—ï¼ˆä»éªŒè¯é€šè¿‡å¼€å§‹è®¡ç®—ï¼‰
            setTimeout(hideLoading, 2000);
          }
        }
      } catch (e) {
        console.error('æ£€æŸ¥URLæ—¶å‡ºé”™:', e);
      }
    }

    embedElement.onload = () => {
      isLoaded = true;
      checkEmbedUrl(); // åŠ è½½å®Œæˆåç«‹å³æ£€æŸ¥URL
      
      // å¦‚æœURLå·²éªŒè¯ï¼Œå¼€å§‹10ç§’å€’è®¡æ—¶
      if (urlVerified) {
        setTimeout(hideLoading, 10000);
      }
    };

    embedElement.onerror = () => {
      clearTimeout(loadingTimer);
      clearInterval(checkTimer);
      hideLoading();
      showError();
    };

    function hideLoading() {
      loadingOverlay.style.opacity = '0';
      setTimeout(() => {
        loadingOverlay.style.display = 'none';
      }, 500);
    }

    function showError() {
      errorMessage.style.display = 'block';
    }

    window.addEventListener('resize', () => {
      embedElement.style.width = '100%';
      embedElement.style.height = '100%';
    });

    embedElement.style.width = '100%';
    embedElement.style.height = '100%';
    initLoadingTimer();
    
    // å®šæœŸæ£€æŸ¥URLï¼ˆä»¥é˜²onloadäº‹ä»¶æœªè§¦å‘ï¼‰
    checkTimer = setInterval(checkEmbedUrl, 1000);
    
    // è®¾ç½®å¹´ä»½
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
